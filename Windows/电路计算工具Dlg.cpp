// µçÂ·¼ÆËã¹¤¾ßDlg.cpp : implementation file
//

#include "stdafx.h"
#include "µçÂ·¼ÆËã¹¤¾ß.h"
#include "µçÂ·¼ÆËã¹¤¾ßDlg.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#undef THIS_FILE
static char THIS_FILE[] = __FILE__;
#endif

/////////////////////////////////////////////////////////////////////////////
// CAboutDlg dialog used for App About

class CAboutDlg : public CDialog
{
public:
	CAboutDlg();

// Dialog Data
	//{{AFX_DATA(CAboutDlg)
	enum { IDD = IDD_ABOUTBOX };
	//}}AFX_DATA

	// ClassWizard generated virtual function overrides
	//{{AFX_VIRTUAL(CAboutDlg)
	protected:
	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support
	//}}AFX_VIRTUAL

// Implementation
protected:
	//{{AFX_MSG(CAboutDlg)
	//}}AFX_MSG
	DECLARE_MESSAGE_MAP()
};

CAboutDlg::CAboutDlg() : CDialog(CAboutDlg::IDD)
{
	//{{AFX_DATA_INIT(CAboutDlg)
	//}}AFX_DATA_INIT
}

void CAboutDlg::DoDataExchange(CDataExchange* pDX)
{
	CDialog::DoDataExchange(pDX);
	//{{AFX_DATA_MAP(CAboutDlg)
	//}}AFX_DATA_MAP
}

BEGIN_MESSAGE_MAP(CAboutDlg, CDialog)
	//{{AFX_MSG_MAP(CAboutDlg)
		// No message handlers
	//}}AFX_MSG_MAP
END_MESSAGE_MAP()

/////////////////////////////////////////////////////////////////////////////
// CMyDlg dialog

CMyDlg::CMyDlg(CWnd* pParent /*=NULL*/)
	: CDialog(CMyDlg::IDD, pParent)
{
	//{{AFX_DATA_INIT(CMyDlg)
	// NOTE: the ClassWizard will add member initialization here
	//}}AFX_DATA_INIT
	m_hIcon = AfxGetApp()->LoadIcon(IDR_MAINFRAME);


	m_EditDiTongLvBoDianRong = 0.0;
	m_EditDiTongLvBoDianZu = 0.0;
	m_EditDiTongLvBoPinLv = 0.0;

	
	m_EditLRLvBoDianGan = 0.0;
	m_EditLRLvBoDianZu = 0.0;
	m_EditLRLvBoPinLv = 0.0;
}

void CMyDlg::DoDataExchange(CDataExchange* pDX)
{
	CDialog::DoDataExchange(pDX);
	//{{AFX_DATA_MAP(CMyDlg)
	// NOTE: the ClassWizard will add DDX and DDV calls here
	//}}AFX_DATA_MAP

	// RCÂË²¨
	DDX_Text(pDX, EDIT_DITONG_LVBO_DIANRONG, m_EditDiTongLvBoDianRong);
	DDX_Text(pDX, EDIT_DITONG_LVBO_DIANZU, m_EditDiTongLvBoDianZu);
	DDX_Text(pDX, EDIT_DITONG_LVBO_PINLV, m_EditDiTongLvBoPinLv);
	DDX_Control(pDX, COMBO_DITONG_LVBO_DIANRONG, m_ComboDiTongLvBoDianRong);
	DDX_Control(pDX, COMBO_DITONG_LVBO_DIANZU, m_ComboDiTongLvBoDianZu);
	DDX_Control(pDX, COMBO_DITONG_LVBO_PINLV, m_ComboDiTongLvBoPinLv);

	// LRÂË²¨
	DDX_Text(pDX, EDIT_LR_LVBO_DIANGAN, m_EditLRLvBoDianGan);
	DDX_Text(pDX, EDIT_LR_LVBO_DIANZU, m_EditLRLvBoDianZu);
	DDX_Text(pDX, EDIT_LR_LVBO_PINLV, m_EditLRLvBoPinLv);
	DDX_Control(pDX, COMBO_LR_LVBO_DIANGAN, m_ComboLRLvBoDianGan);
	DDX_Control(pDX, COMBO_LR_LVBO_DIANZU, m_ComboLRLvBoDianZu);
	DDX_Control(pDX, COMBO_LR_LVBO_PINLV, m_ComboLRLvBoPinLv);
	
}

BEGIN_MESSAGE_MAP(CMyDlg, CDialog)
	//{{AFX_MSG_MAP(CMyDlg)
	ON_WM_SYSCOMMAND()
	ON_WM_PAINT()
	ON_WM_QUERYDRAGICON()
	ON_BN_CLICKED(BTN_LR_CALC, OnLrCalc)
	ON_BN_CLICKED(BTN_LR_RESET_VALUE, OnLrResetValue)
	ON_BN_CLICKED(BTN_LR_RESET, OnLrReset)
	ON_BN_CLICKED(BTN_RC_CALC, OnRcCalc)
	ON_BN_CLICKED(BTN_RC_RESET_VALUE, OnRcResetValue)
	ON_BN_CLICKED(BTN_RC_RESET, OnRcReset)
	//}}AFX_MSG_MAP
#ifdef VS2010
	ON_EN_CHANGE(EDIT_DITONG_LVBO_DIANRONG, &CMyDlg::OnChangeEditDitongLvboDianrong)
	ON_EN_CHANGE(EDIT_DITONG_LVBO_DIANZU, &CMyDlg::OnEnChangeDitongLvboDianzu)
	ON_EN_CHANGE(EDIT_DITONG_LVBO_PINLV, &CMyDlg::OnEnChangeDitongLvboPinlv)
	
	ON_EN_CHANGE(EDIT_LR_LVBO_DIANGAN, &CMyDlg::OnChangeEditLRLvboDianGan)
	ON_EN_CHANGE(EDIT_LR_LVBO_DIANZU, &CMyDlg::OnEnChangeLRLvboDianzu)
	ON_EN_CHANGE(EDIT_LR_LVBO_PINLV, &CMyDlg::OnEnChangeLRLvboPinlv)
#else
	ON_EN_CHANGE(EDIT_DITONG_LVBO_DIANRONG, CMyDlg::OnChangeEditDitongLvboDianrong)
	ON_EN_CHANGE(EDIT_DITONG_LVBO_DIANZU, CMyDlg::OnEnChangeDitongLvboDianzu)
	ON_EN_CHANGE(EDIT_DITONG_LVBO_PINLV, CMyDlg::OnEnChangeDitongLvboPinlv)
	
	ON_EN_CHANGE(EDIT_LR_LVBO_DIANGAN, CMyDlg::OnChangeEditLRLvboDianGan)
	ON_EN_CHANGE(EDIT_LR_LVBO_DIANZU, CMyDlg::OnEnChangeLRLvboDianzu)
	ON_EN_CHANGE(EDIT_LR_LVBO_PINLV, CMyDlg::OnEnChangeLRLvboPinlv)
#endif
END_MESSAGE_MAP()

/////////////////////////////////////////////////////////////////////////////
// CMyDlg message handlers

BOOL CMyDlg::OnInitDialog()
{
	CDialog::OnInitDialog();

	// Add "About..." menu item to system menu.

	// IDM_ABOUTBOX must be in the system command range.
	ASSERT((IDM_ABOUTBOX & 0xFFF0) == IDM_ABOUTBOX);
	ASSERT(IDM_ABOUTBOX < 0xF000);

	CMenu* pSysMenu = GetSystemMenu(FALSE);
	if (pSysMenu != NULL)
	{
		CString strAboutMenu;
		strAboutMenu.LoadString(IDS_ABOUTBOX);
		if (!strAboutMenu.IsEmpty())
		{
			pSysMenu->AppendMenu(MF_SEPARATOR);
			pSysMenu->AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);
		}
	}

	SetIcon(m_hIcon, TRUE);			// Set big icon
	SetIcon(m_hIcon, FALSE);		// Set small icon
	
	// TODO: Add extra initialization here

	// RCÂË²¨µç×èµ¥Î»
	m_ComboDiTongLvBoDianZu.AddString("Æ¤Å· - p¦¸ (Picoohm)");
	m_ComboDiTongLvBoDianZu.AddString("ÄÉÅ· - n¦¸ (Nanoohm)");
	m_ComboDiTongLvBoDianZu.AddString("Î¢Å· - ¦Ì¦¸(Microohm)");
	m_ComboDiTongLvBoDianZu.AddString("ºÁÅ· - m¦¸ (Milliohm)");
	m_ComboDiTongLvBoDianZu.AddString("Å·Ä· - ¦¸  (Ohm)");
	m_ComboDiTongLvBoDianZu.AddString("Ç§Å· - K¦¸ (Kiloohm)");
	m_ComboDiTongLvBoDianZu.AddString("Õ×Å· - M¦¸ (Megaohm)");
	m_ComboDiTongLvBoDianZu.AddString("¼ªÅ· - G¦¸ (Gigaohm)");
	m_ComboDiTongLvBoDianZu.AddString("Ì«Å· - T¦¸ (Teraohm)");
	m_ComboDiTongLvBoDianZu.SetCurSel(4);

	// RCÂË²¨µçÈÝµ¥Î»
	m_ComboDiTongLvBoDianRong.AddString("·É·¨ - fF  (femtofarad)");
	m_ComboDiTongLvBoDianRong.AddString("Æ¤·¨ - pF  (picofarad)");
	m_ComboDiTongLvBoDianRong.AddString("ÄÉ·¨ - nF  (nanofarad)");
	m_ComboDiTongLvBoDianRong.AddString("Î¢·¨ - ¦ÌF (microfarad)");
	m_ComboDiTongLvBoDianRong.AddString("ºÁ·¨ - mF  (millifarad)");
	m_ComboDiTongLvBoDianRong.AddString("·¨À­ - F   (Farad)");
	m_ComboDiTongLvBoDianRong.SetCurSel(2);

	// ½ØÖ¹ÆµÂÊµ¥Î»
	m_ComboDiTongLvBoPinLv.AddString("ºÕ×È - Hz  (hertz)");
	m_ComboDiTongLvBoPinLv.AddString("Ç§ºÕ - kHz (kilohertz)");
	m_ComboDiTongLvBoPinLv.AddString("Õ×ºÕ - MHz (megahertz)");
	m_ComboDiTongLvBoPinLv.AddString("¼ªºÕ - GHz (gigahertz)");
	m_ComboDiTongLvBoPinLv.AddString("Ì«ºÕ - THz (terahertz)");
	m_ComboDiTongLvBoPinLv.AddString("ÅÄºÕ - PHz (petahertz)");
	m_ComboDiTongLvBoPinLv.AddString("°¬ºÕ - EHz (exahertz)");
	m_ComboDiTongLvBoPinLv.SetCurSel(0);

	
	//////////////////////////////////////////////////////////////////////////
	// LRÂË²¨µç×èµ¥Î»
	m_ComboLRLvBoDianZu.AddString("Æ¤Å· - p¦¸ (Picoohm)");
	m_ComboLRLvBoDianZu.AddString("ÄÉÅ· - n¦¸ (Nanoohm)");
	m_ComboLRLvBoDianZu.AddString("Î¢Å· - ¦Ì¦¸(Microohm)");
	m_ComboLRLvBoDianZu.AddString("ºÁÅ· - m¦¸ (Milliohm)");
	m_ComboLRLvBoDianZu.AddString("Å·Ä· - ¦¸  (Ohm)");
	m_ComboLRLvBoDianZu.AddString("Ç§Å· - K¦¸ (Kiloohm)");
	m_ComboLRLvBoDianZu.AddString("Õ×Å· - M¦¸ (Megaohm)");
	m_ComboLRLvBoDianZu.AddString("¼ªÅ· - G¦¸ (Gigaohm)");
	m_ComboLRLvBoDianZu.AddString("Ì«Å· - T¦¸ (Teraohm)");
	m_ComboLRLvBoDianZu.SetCurSel(4);

	// LRÂË²¨µç¸Ðµ¥Î»
	m_ComboLRLvBoDianGan.AddString("Æ¤ºà - pH (Picohenry)");
	m_ComboLRLvBoDianGan.AddString("ÄÉºà - nH (Nanohenry)");
	m_ComboLRLvBoDianGan.AddString("Î¢ºà - ¦ÌH (Microhenry)");
	m_ComboLRLvBoDianGan.AddString("ºÁºà - mH (Millihenry)");
	m_ComboLRLvBoDianGan.AddString("ºàÀû - H (Henry)");
	m_ComboLRLvBoDianGan.AddString("Ç§ºà - kH (Kilohenry)");
	m_ComboLRLvBoDianGan.AddString("Õ×ºà - MH (Megahenry)");
	m_ComboLRLvBoDianGan.AddString("¼ªºà - GH (Gigahenry)");
	m_ComboLRLvBoDianGan.AddString("Ì«ºà - TH (Terahenry)");
	m_ComboLRLvBoDianGan.SetCurSel(2);
	
	// ½ØÖ¹ÆµÂÊµ¥Î»
	m_ComboLRLvBoPinLv.AddString("ºÕ×È - Hz  (hertz)");
	m_ComboLRLvBoPinLv.AddString("Ç§ºÕ - kHz (kilohertz)");
	m_ComboLRLvBoPinLv.AddString("Õ×ºÕ - MHz (megahertz)");
	m_ComboLRLvBoPinLv.AddString("¼ªºÕ - GHz (gigahertz)");
	m_ComboLRLvBoPinLv.AddString("Ì«ºÕ - THz (terahertz)");
	m_ComboLRLvBoPinLv.AddString("ÅÄºÕ - PHz (petahertz)");
	m_ComboLRLvBoPinLv.AddString("°¬ºÕ - EHz (exahertz)");
	m_ComboLRLvBoPinLv.SetCurSel(0);
	//////////////////////////////////////////////////////////////////////////


	return TRUE;  // return TRUE  unless you set the focus to a control
}

void CMyDlg::OnSysCommand(UINT nID, LPARAM lParam)
{
	if ((nID & 0xFFF0) == IDM_ABOUTBOX)
	{
		CAboutDlg dlgAbout;
		dlgAbout.DoModal();
	}
	else
	{
		CDialog::OnSysCommand(nID, lParam);
	}
}

// If you add a minimize button to your dialog, you will need the code below
//  to draw the icon.  For MFC applications using the document/view model,
//  this is automatically done for you by the framework.

void CMyDlg::OnPaint() 
{
	if (IsIconic())
	{
		CPaintDC dc(this); // device context for painting

		SendMessage(WM_ICONERASEBKGND, (WPARAM) dc.GetSafeHdc(), 0);

		// Center icon in client rectangle
		int cxIcon = GetSystemMetrics(SM_CXICON);
		int cyIcon = GetSystemMetrics(SM_CYICON);
		CRect rect;
		GetClientRect(&rect);
		int x = (rect.Width() - cxIcon + 1) / 2;
		int y = (rect.Height() - cyIcon + 1) / 2;

		// Draw the icon
		dc.DrawIcon(x, y, m_hIcon);
	}
	else
	{
		CDialog::OnPaint();
	}
}

HCURSOR CMyDlg::OnQueryDragIcon()
{
	return (HCURSOR) m_hIcon;
}


BOOL CMyDlg::PreTranslateMessage(MSG* pMsg)
{
	// TODO: ÔÚ´ËÌí¼Ó×¨ÓÃ´úÂëºÍ/»òµ÷ÓÃ»ùÀà

// 	switch(pMsg->message)
// 	{
// 		case wm_ed
// 	}

	return CDialog::PreTranslateMessage(pMsg);
}


// RCÂË²¨µçÈÝ
void CMyDlg::OnChangeEditDitongLvboDianrong()
{
	CString strText;
	GetDlgItemText(EDIT_DITONG_LVBO_DIANRONG, strText);

	// Èç¹û±à¼­¿òÎª¿Õ£¬×Ô¶¯Ìî³ä0
	if (strText.IsEmpty())
	{
		SetDlgItemText(EDIT_DITONG_LVBO_DIANRONG, _T("0"));
		// ¿ÉÑ¡£º½«¹â±êÒÆ¶¯µ½Ä©Î²
		CEdit* pEdit = (CEdit*)GetDlgItem(EDIT_DITONG_LVBO_DIANRONG);
		pEdit->SetSel(1, 1);
	}
}

// RCÂË²¨µç×è
void CMyDlg::OnEnChangeDitongLvboDianzu()
{
	CString strText;
	GetDlgItemText(EDIT_DITONG_LVBO_DIANZU, strText);

	// Èç¹û±à¼­¿òÎª¿Õ£¬×Ô¶¯Ìî³ä0
	if (strText.IsEmpty())
	{
		SetDlgItemText(EDIT_DITONG_LVBO_DIANZU, _T("0"));
		// ¿ÉÑ¡£º½«¹â±êÒÆ¶¯µ½Ä©Î²
		CEdit* pEdit = (CEdit*)GetDlgItem(EDIT_DITONG_LVBO_DIANZU);
		pEdit->SetSel(1, 1);
	}
}

// RCÂË²¨ÆµÂÊ
void CMyDlg::OnEnChangeDitongLvboPinlv()
{
	CString strText;
	GetDlgItemText(EDIT_DITONG_LVBO_PINLV, strText);

	// Èç¹û±à¼­¿òÎª¿Õ£¬×Ô¶¯Ìî³ä0
	if(strText.IsEmpty())
	{
		SetDlgItemText(EDIT_DITONG_LVBO_PINLV, _T("0"));
		// ¿ÉÑ¡£º½«¹â±êÒÆ¶¯µ½Ä©Î²
		CEdit* pEdit = (CEdit*)GetDlgItem(EDIT_DITONG_LVBO_PINLV);
		pEdit->SetSel(1, 1);
	}
}



//////////////////////////////////////////////////////////////////////////
// LRÂË²¨µç¸Ð
void CMyDlg::OnChangeEditLRLvboDianGan()
{
	CString strText;
	GetDlgItemText(EDIT_LR_LVBO_DIANGAN, strText);
	
	// Èç¹û±à¼­¿òÎª¿Õ£¬×Ô¶¯Ìî³ä0
	if (strText.IsEmpty())
	{
		SetDlgItemText(EDIT_LR_LVBO_DIANGAN, _T("0"));
		// ¿ÉÑ¡£º½«¹â±êÒÆ¶¯µ½Ä©Î²
		CEdit* pEdit = (CEdit*)GetDlgItem(EDIT_LR_LVBO_DIANGAN);
		pEdit->SetSel(1, 1);
	}
}

// LRÂË²¨µç×è
void CMyDlg::OnEnChangeLRLvboDianzu()
{
	CString strText;
	GetDlgItemText(EDIT_LR_LVBO_DIANZU, strText);
	
	// Èç¹û±à¼­¿òÎª¿Õ£¬×Ô¶¯Ìî³ä0
	if (strText.IsEmpty())
	{
		SetDlgItemText(EDIT_LR_LVBO_DIANZU, _T("0"));
		// ¿ÉÑ¡£º½«¹â±êÒÆ¶¯µ½Ä©Î²
		CEdit* pEdit = (CEdit*)GetDlgItem(EDIT_LR_LVBO_DIANZU);
		pEdit->SetSel(1, 1);
	}
}

// LRÂË²¨ÆµÂÊ
void CMyDlg::OnEnChangeLRLvboPinlv()
{
	CString strText;
	GetDlgItemText(EDIT_LR_LVBO_PINLV, strText);
	
	// Èç¹û±à¼­¿òÎª¿Õ£¬×Ô¶¯Ìî³ä0
	if(strText.IsEmpty())
	{
		SetDlgItemText(EDIT_LR_LVBO_PINLV, _T("0"));
		// ¿ÉÑ¡£º½«¹â±êÒÆ¶¯µ½Ä©Î²
		CEdit* pEdit = (CEdit*)GetDlgItem(EDIT_LR_LVBO_PINLV);
		pEdit->SetSel(1, 1);
	}
}

void CMyDlg::OnRcCalc()
{
	UpdateData();

	// µç×è
	double dDianZu = 0;
	// µçÈÝ
	double dDianRong = 0;
	// ½ØÖ¹ÆµÂÊ
	double dZuZhiPinLv = 0;

	// ÅÐ¶ÏµçÈÝÎª¿ÕÔòÌîÐ´Ä¬ÈÏ100nf
	if((m_EditDiTongLvBoDianRong == 0 && m_EditDiTongLvBoDianZu == 0 && m_EditDiTongLvBoPinLv == 0)
	|| (m_EditDiTongLvBoDianRong == 0 && m_EditDiTongLvBoDianZu == 0 && m_EditDiTongLvBoPinLv != 0))
	{
		m_EditDiTongLvBoDianRong = 100.0f;
		m_ComboDiTongLvBoDianRong.SetCurSel(2);
	}

	// µç×è
	switch(m_ComboDiTongLvBoDianZu.GetCurSel())
	{
		// Î¢Å· - ¦Ì¦¸ (Microohm)
	case 0: {dDianZu = m_EditDiTongLvBoDianZu / 1000 / 1000 / 1000 / 1000;} break;
		// Î¢Å· - ¦Ì¦¸ (Microohm)
	case 1: {dDianZu = m_EditDiTongLvBoDianZu / 1000 / 1000 / 1000;} break;
		// Î¢Å· - ¦Ì¦¸ (Microohm)
	case 2: {dDianZu = m_EditDiTongLvBoDianZu / 1000 / 1000;} break;
		// ºÁÅ· - m¦¸  (Milliohm)
	case 3: {dDianZu = m_EditDiTongLvBoDianZu / 1000;} break;
		// Å·Ä· - ¦¸   (Ohm)
	case 4: {/*no do...*/dDianZu = m_EditDiTongLvBoDianZu;} break;
		// Ç§Å· - K¦¸  (Kiloohm)
	case 5: {dDianZu = m_EditDiTongLvBoDianZu * 1000;} break;
		// Õ×Å· - M¦¸  (Megaohm)
	case 6: {dDianZu = m_EditDiTongLvBoDianZu * 1000 * 1000;} break;
		// ¼ªÅ· - G¦¸  (Gigaohm)
	case 7: {dDianZu = m_EditDiTongLvBoDianZu * 1000 * 1000 * 1000;} break;
		// Ì«Å· - T¦¸  (Teraohm)
	case 8: {dDianZu = m_EditDiTongLvBoDianZu * 1000 * 1000 * 1000 * 1000;} break;
	}

	// µçÈÝ
	switch(m_ComboDiTongLvBoDianRong.GetCurSel())
	{
		// ·É·¨ - fF  (femtofarad)
	case 0: {dDianRong = m_EditDiTongLvBoDianRong / 1000 / 1000 / 1000 / 1000 / 1000;} break;
		// Æ¤·¨ - pF  (picofarad)
	case 1: {dDianRong = m_EditDiTongLvBoDianRong / 1000 / 1000 / 1000 / 1000;} break;
		// ÄÉ·¨ - nF  (nanofarad)
	case 2: {dDianRong = m_EditDiTongLvBoDianRong / 1000 / 1000 / 1000;} break;
		// Î¢·¨ - ¦ÌF (microfarad)
	case 3: {dDianRong = m_EditDiTongLvBoDianRong / 1000 / 1000;} break;
		// ºÁ·¨ - mF  (millifarad)
	case 4: {dDianRong = m_EditDiTongLvBoDianRong / 1000;} break;
		// ·¨À­ - F   (Farad)
	case 5: {/*no do...*/dDianRong = m_EditDiTongLvBoDianRong;} break;
	}

	// ½ØÖ¹ÆµÂÊ
	switch(m_ComboDiTongLvBoPinLv.GetCurSel())
	{
		// ºÕ×È - Hz  (hertz)
	case 0: {dZuZhiPinLv = m_EditDiTongLvBoPinLv;} break;
		// Ç§ºÕ - kHz (kilohertz)
	case 1: {dZuZhiPinLv = m_EditDiTongLvBoPinLv * 1000;} break;
		// Õ×ºÕ - MHz (megahertz)
	case 2: {dZuZhiPinLv = m_EditDiTongLvBoPinLv * 1000 * 1000;} break;
		// ¼ªºÕ - GHz (gigahertz)
	case 3: {dZuZhiPinLv = m_EditDiTongLvBoPinLv * 1000 * 1000 * 1000;} break;
		// Ì«ºÕ - THz (terahertz)
	case 4: {dZuZhiPinLv = m_EditDiTongLvBoPinLv * 1000 * 1000 * 1000 * 1000;} break;
		// ÅÄºÕ - PHz (petahertz)
	case 5: {dZuZhiPinLv = m_EditDiTongLvBoPinLv * 1000 * 1000 * 1000 * 1000 * 1000;} break;
		// °¬ºÕ - EHz (exahertz)
	case 6: {dZuZhiPinLv = m_EditDiTongLvBoPinLv * 1000 * 1000 * 1000 * 1000 * 1000 * 1000;} break;
	}


	// ÅÐ¶Ï½ØÖ¹ÆµÂÊÎª¿ÕÔò±íÊ¾Í¨¹ýµç×èºÍµçÈÝ¼ÆËã½ØÖ¹ÆµÂÊ
	if(m_EditDiTongLvBoPinLv == 0 || (m_EditDiTongLvBoDianRong != 0 && m_EditDiTongLvBoDianZu != 0 && m_EditDiTongLvBoPinLv != 0))
	{
		m_EditDiTongLvBoPinLv = 1 / (2 * PI * dDianZu * dDianRong);

		bool bCmp = false;
		double dValue = 1;
		dZuZhiPinLv = m_EditDiTongLvBoPinLv;

		if(dZuZhiPinLv > dValue)
		{
			bCmp = 1;
		}
		else
		{
			bCmp = 0;
		}

		for(int i = 0; i < 6; i++)
		{
			if(bCmp)
			{
				if(dZuZhiPinLv < dValue)
				{
					m_ComboDiTongLvBoPinLv.SetCurSel(i);
					break;
				}
				dValue *= 1000;
				dZuZhiPinLv /= 1000;
			}
			else
			{
				m_ComboDiTongLvBoPinLv.SetCurSel(i);
				break;
			}
		}

		m_EditDiTongLvBoPinLv = dZuZhiPinLv;
	}

	// ÅÐ¶ÏµçÈÝÎª¿ÕÔò±íÊ¾Í¨¹ý½ØÖ¹ÆµÂÊºÍµç×è¼ÆËãµçÈÝ
	if(m_EditDiTongLvBoDianRong == 0)
	{
		if(m_EditDiTongLvBoDianZu != 0 && m_EditDiTongLvBoPinLv != 0)
		{
			m_EditDiTongLvBoDianRong = 1 / (2 * PI * dDianZu * dZuZhiPinLv);

			bool bCmp = false;
			double dValue = 1;
			dDianRong = m_EditDiTongLvBoDianRong;

			if(dDianRong > dValue)
			{
				bCmp = 1;
				dValue = 1000;
			}
			else
			{
				bCmp = 0;
			}

			for(int i = 0; i < 6; i++)
			{
				if(bCmp)
				{
					if(dDianRong < dValue)
					{
						m_ComboDiTongLvBoDianRong.SetCurSel(i);
						break;
					}
					dValue *= 1000;
					dDianRong /= 1000;
				}
				else
				{
					if(dDianRong > dValue)
					{
						m_ComboDiTongLvBoDianRong.SetCurSel(6-i-1);
						break;
					}
					dValue = 1;
					dDianRong *= 1000;
				}
			}

			m_EditDiTongLvBoDianRong = dDianRong;
		}
		else
		{
			// Ã»ÌîÐ´ÊýÖµ
			MessageBox("ÊýÖµÃ»ÓÐÌîÐ´ÍêÈ«, Çë¼ì²é...", NULL, MB_ICONINFORMATION);
		}
	}

	// ÅÐ¶Ïµç×èÎª¿ÕÔò±íÊ¾Í¨¹ý½ØÖ¹ÆµÂÊºÍµçÈÝ¼ÆËãµç×è
	if(m_EditDiTongLvBoDianZu == 0)
	{
		if(m_EditDiTongLvBoDianRong != 0 && m_EditDiTongLvBoPinLv != 0)
		{
			m_EditDiTongLvBoDianZu = 1 / (2 * PI * dDianRong * dZuZhiPinLv);

			bool bCmp = false;
			double dValue = 1;
			dDianZu = m_EditDiTongLvBoDianZu;

			if(dDianZu > dValue)
			{
				bCmp = 1;
				dValue = 1000;
			}
			else
			{
				bCmp = 0;
			}

			for(int i = 0; i < 6; i++)
			{
				if(bCmp)
				{
					// ½ØÖ¹ÆµÂÊÊÇ 106.10329539763 kHz  µçÈÝÊÇ 100nF, ¼ÆËãµç×èÊÇ 14.999999999999 ¦¸
					// ½ØÖ¹ÆµÂÊÊÇ 100 kHz  µçÈÝÊÇ 1nF, ¼ÆËãµç×èÊÇ 15.9 K¦¸
					if(dDianZu < dValue)
					{
						m_ComboDiTongLvBoDianZu.SetCurSel(4+i);
						break;
					}
//					dValue *= 1000;
					dDianZu /= 1000;
				}
				else
				{
					if(dDianZu > dValue)
					{
						m_ComboDiTongLvBoDianZu.SetCurSel(4-i);
						break;
					}
					dValue = 1;
					dDianZu *= 1000;
				}
			}

			m_EditDiTongLvBoDianZu = dDianZu;
		}
		else
		{
			// Ã»ÌîÐ´ÊýÖµ
			MessageBox("ÊýÖµÃ»ÓÐÌîÐ´ÍêÈ«, Çë¼ì²é...", NULL, MB_ICONINFORMATION);
		}
	}


	UpdateData(FALSE);
}


void CMyDlg::OnRcResetValue() 
{
	m_EditDiTongLvBoDianZu = 0;
	m_EditDiTongLvBoDianRong = 0;
	m_EditDiTongLvBoPinLv = 0;
	UpdateData(FALSE);
}

void CMyDlg::OnRcReset() 
{
	m_ComboDiTongLvBoDianZu.SetCurSel(4);
	m_ComboDiTongLvBoDianRong.SetCurSel(2);
	m_ComboDiTongLvBoPinLv.SetCurSel(0);
}

void CMyDlg::OnLrCalc() 
{
	UpdateData();

	// µç×è
	double dDianZu = 0;
	// µçÈÝ
	double dDianGan = 0;
	// ½ØÖ¹ÆµÂÊ
	double dZuZhiPinLv = 0;

	// ÅÐ¶Ïµç¸ÐÎª¿ÕÔòÌîÐ´Ä¬ÈÏ100nf
	if((m_EditLRLvBoDianGan == 0 && m_EditLRLvBoDianZu == 0 && m_EditLRLvBoPinLv == 0)
	|| (m_EditLRLvBoDianGan == 0 && m_EditLRLvBoDianZu == 0 && m_EditLRLvBoPinLv != 0))
	{
		m_EditLRLvBoDianGan = 100.0f;
		m_ComboLRLvBoDianGan.SetCurSel(2);
	}

	// µç×è
	switch(m_ComboLRLvBoDianZu.GetCurSel())
	{
		// Î¢Å· - ¦Ì¦¸ (Microohm)
	case 0: {dDianZu = m_EditLRLvBoDianZu / 1000 / 1000 / 1000 / 1000;} break;
		// Î¢Å· - ¦Ì¦¸ (Microohm)
	case 1: {dDianZu = m_EditLRLvBoDianZu / 1000 / 1000 / 1000;} break;
		// Î¢Å· - ¦Ì¦¸ (Microohm)
	case 2: {dDianZu = m_EditLRLvBoDianZu / 1000 / 1000;} break;
		// ºÁÅ· - m¦¸  (Milliohm)
	case 3: {dDianZu = m_EditLRLvBoDianZu / 1000;} break;
		// Å·Ä· - ¦¸   (Ohm)
	case 4: {/*no do...*/dDianZu = m_EditLRLvBoDianZu;} break;
		// Ç§Å· - K¦¸  (Kiloohm)
	case 5: {dDianZu = m_EditLRLvBoDianZu * 1000;} break;
		// Õ×Å· - M¦¸  (Megaohm)
	case 6: {dDianZu = m_EditLRLvBoDianZu * 1000 * 1000;} break;
		// ¼ªÅ· - G¦¸  (Gigaohm)
	case 7: {dDianZu = m_EditLRLvBoDianZu * 1000 * 1000 * 1000;} break;
		// Ì«Å· - T¦¸  (Teraohm)
	case 8: {dDianZu = m_EditLRLvBoDianZu * 1000 * 1000 * 1000 * 1000;} break;
	}

	// µç¸Ð
	switch(m_ComboLRLvBoDianGan.GetCurSel())
	{
		// Æ¤ºà - pH (Picohenry)
	case 0: {dDianGan = m_EditLRLvBoDianGan / 1000 / 1000 / 1000 / 1000;} break;
		// ÄÉºà - nH (Nanohenry)
	case 1: {dDianGan = m_EditLRLvBoDianGan / 1000 / 1000 / 1000;} break;
		// Î¢ºà - ¦ÌH (Microhenry)
	case 2: {dDianGan = m_EditLRLvBoDianGan / 1000 / 1000;} break;
		// ºÁºà - mH (Millihenry)
	case 3: {dDianGan = m_EditLRLvBoDianGan / 1000;} break;
		// ºàÀû - H (Henry)
	case 4: {/*no do...*/dDianGan = m_EditLRLvBoDianGan;} break;
		// Ç§ºà - kH (Kilohenry)
	case 5: {dDianGan = m_EditLRLvBoDianGan * 1000;} break;
		// Õ×ºà - MH (Megahenry)
	case 6: {dDianGan = m_EditLRLvBoDianGan * 1000 * 1000;} break;
		// ¼ªºà - GH (Gigahenry)
	case 7: {dDianGan = m_EditLRLvBoDianGan * 1000 * 1000 * 1000;} break;
		// Ì«ºà - TH (Terahenry)
	case 8: {dDianGan = m_EditLRLvBoDianGan * 1000 * 1000 * 1000 * 1000;} break;
	}

	// ½ØÖ¹ÆµÂÊ
	switch(m_ComboLRLvBoPinLv.GetCurSel())
	{
		// ºÕ×È - Hz  (hertz)
	case 0: {dZuZhiPinLv = m_EditLRLvBoPinLv;} break;
		// Ç§ºÕ - kHz (kilohertz)
	case 1: {dZuZhiPinLv = m_EditLRLvBoPinLv * 1000;} break;
		// Õ×ºÕ - MHz (megahertz)
	case 2: {dZuZhiPinLv = m_EditLRLvBoPinLv * 1000 * 1000;} break;
		// ¼ªºÕ - GHz (gigahertz)
	case 3: {dZuZhiPinLv = m_EditLRLvBoPinLv * 1000 * 1000 * 1000;} break;
		// Ì«ºÕ - THz (terahertz)
	case 4: {dZuZhiPinLv = m_EditLRLvBoPinLv * 1000 * 1000 * 1000 * 1000;} break;
		// ÅÄºÕ - PHz (petahertz)
	case 5: {dZuZhiPinLv = m_EditLRLvBoPinLv * 1000 * 1000 * 1000 * 1000 * 1000;} break;
		// °¬ºÕ - EHz (exahertz)
	case 6: {dZuZhiPinLv = m_EditLRLvBoPinLv * 1000 * 1000 * 1000 * 1000 * 1000 * 1000;} break;
	}


	// ÅÐ¶Ï½ØÖ¹ÆµÂÊÎª¿ÕÔò±íÊ¾Í¨¹ýµç×èºÍµç¸Ð¼ÆËã½ØÖ¹ÆµÂÊ
	if(m_EditLRLvBoPinLv == 0 || (m_EditLRLvBoDianGan != 0 && m_EditLRLvBoDianZu != 0 && m_EditLRLvBoPinLv != 0))
	{
		m_EditLRLvBoPinLv = dDianZu / (2 * PI * dDianGan);

		bool bCmp = false;
		double dValue = 1;
		dZuZhiPinLv = m_EditLRLvBoPinLv;

		if(dZuZhiPinLv > dValue)
		{
			bCmp = 1;
		}
		else
		{
			bCmp = 0;
		}

		for(int i = 0; i < 6; i++)
		{
			if(bCmp)
			{
				if(dZuZhiPinLv < dValue)
				{
					m_ComboLRLvBoPinLv.SetCurSel(i);
					break;
				}
				dValue *= 1000;
				dZuZhiPinLv /= 1000;
			}
			else
			{
				m_ComboLRLvBoPinLv.SetCurSel(i);
				break;
			}
		}

		m_EditLRLvBoPinLv = dZuZhiPinLv;
	}

	// ÅÐ¶Ïµç¸ÐÎª¿ÕÔò±íÊ¾Í¨¹ý½ØÖ¹ÆµÂÊºÍµç×è¼ÆËãµç¸Ð
	if(m_EditLRLvBoDianGan == 0)
	{
		if(m_EditLRLvBoDianZu != 0 && m_EditLRLvBoPinLv != 0)
		{
			m_EditLRLvBoDianGan = dDianZu / (2 * PI * dZuZhiPinLv);

			bool bCmp = false;
			double dValue = 1;
			dDianGan = m_EditLRLvBoDianGan;

			if(dDianGan > dValue)
			{
				bCmp = 1;
			}
			else
			{
				bCmp = 0;
			}

			for(int i = 0; i < 6; i++)
			{
				if(bCmp)
				{
					if(dDianGan < dValue)
					{
						m_ComboLRLvBoDianGan.SetCurSel(i);
						break;
					}
					dValue *= 1000;
					dDianGan /= 1000;
				}
				else
				{
					if(dDianGan > dValue)
					{
						m_ComboLRLvBoDianGan.SetCurSel(i);
						break;
					}
					dValue = 1;
					dDianGan *= 1000;
				}
			}

			m_EditLRLvBoDianGan = dDianGan;
		}
		else
		{
			// Ã»ÌîÐ´ÊýÖµ
			MessageBox("ÊýÖµÃ»ÓÐÌîÐ´ÍêÈ«, Çë¼ì²é...", NULL, MB_ICONINFORMATION);
		}
	}

	// ÅÐ¶Ïµç×èÎª¿ÕÔò±íÊ¾Í¨¹ý½ØÖ¹ÆµÂÊºÍµç¸Ð¼ÆËãµç×è
	if(m_EditLRLvBoDianZu == 0)
	{
		if(m_EditLRLvBoDianGan != 0 && m_EditLRLvBoPinLv != 0)
		{
			m_EditLRLvBoDianZu = (2 * PI * dDianGan * dZuZhiPinLv);

			bool bCmp = false;
			double dValue = 1;
			dDianZu = m_EditLRLvBoDianZu;

			if(dDianZu > dValue)
			{
				bCmp = 1;
				dValue = 1000;
			}
			else
			{
				bCmp = 0;
			}

			for(int i = 0; i < 6; i++)
			{
				if(bCmp)
				{
					// ½ØÖ¹ÆµÂÊÊÇ 106.10329539763 kHz  µç¸ÐÊÇ 100nF, ¼ÆËãµç×èÊÇ 14.999999999999 ¦¸
					// ½ØÖ¹ÆµÂÊÊÇ 100 kHz  µç¸ÐÊÇ 1nF, ¼ÆËãµç×èÊÇ 15.9 K¦¸
					if(dDianZu < dValue)
					{
						m_ComboLRLvBoDianZu.SetCurSel(4+i);
						break;
					}
//					dValue *= 1000;
					dDianZu /= 1000;
				}
				else
				{
					if(dDianZu > dValue)
					{
						m_ComboLRLvBoDianZu.SetCurSel(4-i);
						break;
					}
					dValue = 1;
					dDianZu *= 1000;
				}
			}

			m_EditLRLvBoDianZu = dDianZu;
		}
		else
		{
			// Ã»ÌîÐ´ÊýÖµ
			MessageBox("ÊýÖµÃ»ÓÐÌîÐ´ÍêÈ«, Çë¼ì²é...", NULL, MB_ICONINFORMATION);
		}
	}

	UpdateData(FALSE);
}

void CMyDlg::OnLrResetValue() 
{
	m_EditLRLvBoDianZu = 0;
	m_EditLRLvBoDianGan = 0;
	m_EditLRLvBoPinLv = 0;
	UpdateData(FALSE);
}

void CMyDlg::OnLrReset() 
{
	m_ComboLRLvBoDianZu.SetCurSel(4);
	m_ComboLRLvBoDianGan.SetCurSel(2);
	m_ComboLRLvBoPinLv.SetCurSel(0);
}


